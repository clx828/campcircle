# 编辑资料功能说明

## 功能概述

新增了完整的用户资料编辑功能，用户可以通过多个入口编辑个人信息。

## 功能特性

### 🎯 核心功能
- **头像更换** - 支持拍照或从相册选择图片
- **昵称编辑** - 支持2-20个字符的昵称设置
- **个人简介编辑** - 支持最多100字符的个人简介
- **实时保存** - 自动同步到用户store和后端

### 📱 用户体验
- **多入口访问** - 我的页面"编辑资料"按钮 + 头像点击
- **智能验证** - 实时表单验证和字符计数
- **友好提示** - 完整的加载状态和错误提示
- **确认机制** - 未保存修改时的离开确认

### 🎨 界面设计
- **自定义导航栏** - 取消/保存按钮，保存按钮智能启用
- **现代化UI** - 圆角卡片设计，渐变效果
- **响应式布局** - 适配不同设备尺寸
- **加载遮罩** - 优雅的加载动画

## 技术实现

### 📁 文件结构
```
campcircle-ma/
├── pages/editProfile/
│   └── editProfile.vue          # 编辑资料主页面
├── pages/tabbar/mine/mine.vue   # 我的页面（添加入口）
├── pages/tabbar/release/release.vue # 发布页面（头像功能）
└── api/user.ts                  # 用户API接口
```

### 🔧 核心接口
- `userApi.updateMyUser()` - 更新用户资料
- `postApi.uploadPicture()` - 图片上传
- `userStore.setUserInfo()` - 更新本地状态

### 📋 数据流程
1. **页面初始化** - 从userStore获取当前用户信息
2. **表单编辑** - 实时验证和字符计数
3. **头像上传** - 选择图片 → 上传 → 获取URL
4. **保存资料** - 调用API → 更新store → 返回上页

## 使用方式

### 🚀 访问入口

#### 方式一：我的页面按钮
1. 进入"我的"页面
2. 点击"编辑资料"按钮
3. 进入编辑页面

#### 方式二：头像点击
1. 在"我的"页面点击头像
2. 直接进入编辑页面

#### 方式三：发布页面头像
1. 在"发布"页面点击头像
2. 弹出图片选择器直接更换头像

### ✏️ 编辑操作

#### 更换头像
1. 点击头像区域
2. 选择"拍照"或"从相册选择"
3. 系统自动上传并更新预览

#### 编辑昵称
1. 点击昵称输入框
2. 输入新昵称（2-20字符）
3. 实时显示字符计数

#### 编辑简介
1. 点击简介文本框
2. 输入个人简介（最多100字符）
3. 支持多行文本输入

#### 保存修改
1. 修改任意内容后"保存"按钮自动启用
2. 点击"保存"提交修改
3. 显示保存进度和结果提示

### ⚠️ 注意事项

#### 表单验证
- 昵称不能为空，至少2个字符
- 昵称最多20个字符
- 个人简介最多100个字符

#### 离开确认
- 有未保存修改时点击"取消"会弹出确认对话框
- 确认离开将丢失所有未保存的修改

#### 网络处理
- 头像上传失败会显示错误提示
- 保存失败会显示具体错误信息
- 支持重试操作

## API接口说明

### 更新用户资料
```typescript
// 接口定义
userApi.updateMyUser(params: UpdateMyUserParams)

// 参数类型
interface UpdateMyUserParams {
  userAvatar?: string    // 用户头像URL
  userName?: string      // 用户昵称
  userProfile?: string   // 用户简介
}

// 返回类型
interface UpdateMyUserRes {
  code: number          // 状态码，0表示成功
  data: boolean         // 操作结果
  message: string       // 提示信息
}
```

### 图片上传
```typescript
// 接口定义
postApi.uploadPicture(filePath: string)

// 返回数据
{
  code: 0,
  data: {
    pictureUrl: string,  // 图片访问URL
    id: string          // 图片ID
  }
}
```

## 状态管理

### UserStore更新
编辑资料成功后会自动更新用户store：
```typescript
userStore.setUserInfo({
  userName: newUserName,
  userAvatar: newAvatarUrl,
  userProfile: newProfile
})
```

### 页面同步
所有使用用户信息的页面都会自动同步更新：
- 我的页面用户信息
- 发布页面头像显示
- 其他引用用户信息的组件

## 样式特性

### 🎨 设计风格
- **现代化卡片** - 圆角阴影设计
- **品牌色彩** - 主色调#fb0055
- **渐变效果** - 头像编辑悬浮效果
- **响应式** - 适配不同屏幕尺寸

### 📱 交互反馈
- **点击反馈** - 按钮点击缩放效果
- **状态指示** - 保存按钮启用/禁用状态
- **加载动画** - 优雅的loading效果
- **字符计数** - 实时显示输入进度

## 扩展功能

### 🔮 未来可扩展
- 性别选择
- 生日设置
- 地区选择
- 个性标签
- 背景图片
- 隐私设置

### 🛠️ 技术优化
- 图片压缩优化
- 离线编辑支持
- 批量保存机制
- 历史记录功能
