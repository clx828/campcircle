# è¯„è®ºå¼¹çª—é¡µé¢çº§åˆ«å®ç°

## ğŸ¯ è§£å†³æ–¹æ¡ˆ

ç”±äºåœ¨uni-appä¸­Teleportå¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œæˆ‘ä»¬æ”¹ä¸ºåœ¨é¡µé¢çº§åˆ«å®ç°è¯„è®ºå¼¹çª—ï¼Œç¡®ä¿å¼¹çª—ä»å±å¹•åº•éƒ¨å¼¹å‡ºã€‚

## âœ… å®ç°æ–¹æ¡ˆ

### 1. æ¶æ„è°ƒæ•´

**åŸæ–¹æ¡ˆï¼ˆæœ‰é—®é¢˜ï¼‰**ï¼š
```
SocialCard ç»„ä»¶
â”œâ”€â”€ å¡ç‰‡å†…å®¹
â””â”€â”€ Teleport
    â””â”€â”€ CommentPopup (å¯èƒ½å—çˆ¶å®¹å™¨å½±å“)
```

**æ–°æ–¹æ¡ˆï¼ˆè§£å†³é—®é¢˜ï¼‰**ï¼š
```
é¡µé¢çº§åˆ«
â”œâ”€â”€ SocialCard ç»„ä»¶ (åªè´Ÿè´£è§¦å‘äº‹ä»¶)
â””â”€â”€ CommentPopup ç»„ä»¶ (é¡µé¢çº§åˆ«ï¼Œç¡®ä¿ä»å±å¹•åº•éƒ¨å¼¹å‡º)
```

### 2. ä»£ç å®ç°

**SocialCard.vue ä¿®æ”¹**ï¼š
```vue
<template>
  <view class="social-card">
    <!-- å¡ç‰‡å†…å®¹ -->
    <button @click="handleComment">è¯„è®º</button>
  </view>
  <!-- ç§»é™¤å†…éƒ¨çš„CommentPopup -->
</template>

<script setup>
const emit = defineEmits(['comment', 'share', 'edit', 'delete', 'visibilityChange'])

// å¤„ç†è¯„è®ºæ“ä½œ - è§¦å‘è¯„è®ºäº‹ä»¶
function handleComment() {
    uni.vibrateShort()
    if (props.hideActions) {
        return // è¯¦æƒ…é¡µä¸æ‰§è¡Œæ“ä½œ
    } else {
        // è§¦å‘è¯„è®ºäº‹ä»¶ï¼Œè®©çˆ¶é¡µé¢å¤„ç†
        emit('comment', props.cardInfo.id, props.cardInfo.commentNum)
    }
}
</script>
```

**é¡µé¢çº§åˆ«å®ç°ï¼ˆhome.vueã€follow.vueã€search.vueï¼‰**ï¼š
```vue
<template>
  <view class="page">
    <!-- é¡µé¢å†…å®¹ -->
    <SocialCard 
      v-for="post in postList" 
      :key="post.id" 
      :cardInfo="post" 
      @comment="handleComment"
      @share="handleShare" 
    />
    
    <!-- å…¨å±€è¯„è®ºå¼¹çª— - é¡µé¢çº§åˆ« -->
    <CommentPopup 
        v-model:show="showCommentPopup" 
        :comment-num="commentNum" 
        :post-id="currentPostId" 
        @close="handleCommentPopupClose"
        @comment-success="handleCommentSuccess" 
    />
  </view>
</template>

<script setup>
import CommentPopup from '@/components/CommentPopup.vue'

// è¯„è®ºå¼¹çª—ç›¸å…³
const showCommentPopup = ref(false)
const currentPostId = ref('')
const commentNum = ref(0)

// å¤„ç†è¯„è®ºæŒ‰é’®ç‚¹å‡»
function handleComment(postId: string, postCommentNum: number) {
  currentPostId.value = postId
  commentNum.value = postCommentNum
  showCommentPopup.value = true
}

// å¤„ç†è¯„è®ºå¼¹çª—å…³é—­
function handleCommentPopupClose() {
  showCommentPopup.value = false
  currentPostId.value = ''
}

// å¤„ç†è¯„è®ºæˆåŠŸ
function handleCommentSuccess() {
  showCommentPopup.value = false
  // åˆ·æ–°æ•°æ®é€»è¾‘
}
</script>
```

### 3. CommentPopup æ ·å¼ä¼˜åŒ–

**å¼ºåˆ¶å®šä½æ ·å¼**ï¼š
```scss
.custom-popup {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    z-index: 99999 !important;
    width: 100vw !important;
    height: 100vh !important;
}

.popup-content {
    position: absolute !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
}
```

**è¿›å…¥/ç¦»å¼€åŠ¨ç”»**ï¼š
```vue
<Transition name="popup">
    <view v-if="show" class="custom-popup">
        <!-- å¼¹çª—å†…å®¹ -->
    </view>
</Transition>
```

```scss
.popup-enter-from .popup-content,
.popup-leave-to .popup-content {
    transform: translateY(100%);
}

.popup-enter-to .popup-content,
.popup-leave-from .popup-content {
    transform: translateY(0);
}
```

## ğŸ‰ è§£å†³æ•ˆæœ

### 1. ç¡®ä¿ä»å±å¹•åº•éƒ¨å¼¹å‡º
- âœ… **é¡µé¢çº§åˆ«å®šä½**ï¼šCommentPopupåœ¨é¡µé¢çº§åˆ«ï¼Œä¸å—SocialCardå®¹å™¨å½±å“
- âœ… **å¼ºåˆ¶æ ·å¼**ï¼šä½¿ç”¨`!important`ç¡®ä¿å®šä½æ ·å¼ä¸è¢«è¦†ç›–
- âœ… **å…¨å±è¦†ç›–**ï¼šå¼¹çª—è¦†ç›–æ•´ä¸ªå±å¹•ï¼Œä»åº•éƒ¨æ»‘å…¥

### 2. ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ
- âœ… **æ‰€æœ‰é¡µé¢ä¸€è‡´**ï¼šhomeã€followã€searché¡µé¢éƒ½æœ‰ç›¸åŒçš„è¯„è®ºä½“éªŒ
- âœ… **æµç•…åŠ¨ç”»**ï¼šå¹³æ»‘çš„è¿›å…¥/ç¦»å¼€åŠ¨ç”»
- âœ… **å“åº”å¼è®¾è®¡**ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸

### 3. æŠ€æœ¯ä¼˜åŠ¿
- âœ… **å…¼å®¹æ€§å¥½**ï¼šé¿å…äº†Teleportåœ¨uni-appä¸­çš„å…¼å®¹æ€§é—®é¢˜
- âœ… **æ§åˆ¶ç²¾ç¡®**ï¼šé¡µé¢çº§åˆ«æ§åˆ¶ï¼Œæ›´å®¹æ˜“è°ƒè¯•å’Œç»´æŠ¤
- âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šæ¯ä¸ªé¡µé¢åªæœ‰ä¸€ä¸ªè¯„è®ºå¼¹çª—å®ä¾‹

## ğŸ“± é¡µé¢å®ç°çŠ¶æ€

### âœ… å·²å®ç°é¡µé¢
1. **home.vue** - é¦–é¡µè¯„è®ºå¼¹çª—
2. **follow.vue** - å…³æ³¨é¡µè¯„è®ºå¼¹çª—  
3. **search.vue** - æœç´¢é¡µè¯„è®ºå¼¹çª—

### ğŸ”„ ä½¿ç”¨æµç¨‹
1. ç”¨æˆ·ç‚¹å‡»SocialCardçš„è¯„è®ºå›¾æ ‡
2. SocialCardè§¦å‘`comment`äº‹ä»¶
3. é¡µé¢æ¥æ”¶äº‹ä»¶ï¼Œè®¾ç½®å¼¹çª—å‚æ•°
4. æ˜¾ç¤ºè¯„è®ºå¼¹çª—ï¼ˆä»å±å¹•åº•éƒ¨å¼¹å‡ºï¼‰
5. ç”¨æˆ·å®Œæˆè¯„è®ºæˆ–å…³é—­å¼¹çª—
6. é¡µé¢å¤„ç†ç»“æœå¹¶éšè—å¼¹çª—

### ğŸ¯ å…³é”®ç‰¹æ€§
- **ä»å±å¹•åº•éƒ¨å¼¹å‡º**ï¼šæ— è®ºSocialCardåœ¨é¡µé¢ä»€ä¹ˆä½ç½®
- **å…¨å±é®ç½©**ï¼šèƒŒæ™¯åŠé€æ˜é®ç½©è¦†ç›–æ•´ä¸ªå±å¹•
- **å¹³æ»‘åŠ¨ç”»**ï¼š300msçš„æ»‘å…¥/æ»‘å‡ºåŠ¨ç”»
- **é”®ç›˜é€‚é…**ï¼šè‡ªåŠ¨é€‚é…è½¯é”®ç›˜å¼¹å‡º

## ğŸš€ æµ‹è¯•éªŒè¯

ç°åœ¨æ‚¨å¯ä»¥æµ‹è¯•ï¼š
1. åœ¨é¦–é¡µç‚¹å‡»ä»»æ„å¸–å­çš„è¯„è®ºå›¾æ ‡
2. åœ¨å…³æ³¨é¡µç‚¹å‡»ä»»æ„å¸–å­çš„è¯„è®ºå›¾æ ‡  
3. åœ¨æœç´¢é¡µç‚¹å‡»ä»»æ„å¸–å­çš„è¯„è®ºå›¾æ ‡

æ‰€æœ‰é¡µé¢çš„è¯„è®ºå¼¹çª—éƒ½åº”è¯¥ä»å±å¹•åº•éƒ¨å¹³æ»‘å¼¹å‡ºï¼Œæä¾›ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒã€‚

è¿™ä¸ªæ–¹æ¡ˆå½»åº•è§£å†³äº†å¼¹çª—å®šä½é—®é¢˜ï¼Œç¡®ä¿åœ¨æ‰€æœ‰uni-appæ”¯æŒçš„å¹³å°ä¸Šéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚
